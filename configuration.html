


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration &mdash; FAT Arts Combinatòries 1.0a1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="FAT Arts Combinatòries 1.0a1 documentation" href="index.html" />
    <link rel="next" title="Managing data" href="managing_data.html" />
    <link rel="prev" title="Migració" href="migracio.html" />
<link type="text/css" href="_static/fatdoc.css" rel="stylesheet">

  </head>
  <body>
<div class="header">
    <a href="#">
        <img alt="Logo" src="_static/logo.jpg" class="logo" />
    </a>
</div>
    

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="managing_data.html" title="Managing data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="migracio.html" title="Migració"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">FAT Arts Combinatòries 1.0a1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#step-1-virtuoso">Step 1: Virtuoso</a></li>
<li><a class="reference internal" href="#step-2-solr">Step 2: Solr</a></li>
<li><a class="reference internal" href="#step-3-main-properties">Step 3: Main properties</a></li>
<li><a class="reference internal" href="#step-4-reset">Step 4: Reset</a></li>
<li><a class="reference internal" href="#step-5-legal-script">Step 5: Legal script</a></li>
<li><a class="reference internal" href="#step-6-data-mapping">Step 6: Data mapping</a></li>
<li><a class="reference internal" href="#step-7-object-template">Step 7: Object template</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-8-video-profiles">Step 8: Video Profiles</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="migracio.html"
                        title="previous chapter">Migració</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="managing_data.html"
                        title="next chapter">Managing data</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/configuration.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>There are several aspects that must be defined in order to get Arts Combinatòries (AC) working with a new Ontology. This configuration guide is organized step-by-step.</p>
<div class="section" id="step-1-virtuoso">
<h2>Step 1: Virtuoso<a class="headerlink" href="#step-1-virtuoso" title="Permalink to this headline">¶</a></h2>
<p>Some Virtuoso initial configuration is necessary. Access to Virtuoso Conductor console (default should be: <a class="reference external" href="http://localhost:8890/conductor/">http://localhost:8890/conductor/</a> with both user and password &#8220;dba&#8221;). Click &#8220;Interactive SQL&#8221; on the right, and run the next sql script:</p>
<div class="highlight-python"><pre>-- Base script which creates necessary data structure for managing users, rights and uploaded media and objects
-- Suitable (only?) for Openlink Virtuoso sql implementation

-- DROP TABLE db.dba._thumbnail;
-- DROP TABLE db.dba._right;
-- DROP TABLE db.dba._identifier_counter;
-- DROP TABLE db.dba._autodata;
-- DROP TABLE db.dba._resource_statistics;

CREATE TABLE db.dba._resource_statistics (
        identifier VARCHAR(150),
        visitCounter BIGINT,
        creationMoment BIGINT,
        lastMoment BIGINT
)

CREATE TABLE db.dba._thumbnail (
        SID INT IDENTITY,
        objectId VARCHAR(60),
        path VARCHAR(500),
        moment TIMESTAMP
)

CREATE TABLE db.dba._right (
        SID INT IDENTITY,
        objectId VARCHAR(60),
        rightLevel INT
)

CREATE TABLE db.dba._identifier_counter (
        identifier VARCHAR(150),
        counter INT
)

CREATE TABLE db.dba._autodata (
        keyName VARCHAR(100),
        keyValue VARCHAR(100),
    name VARCHAR(100),
        defaultValue VARCHAR(100)
)

GRANT EXECUTE ON DB.DBA.SPARQL_DELETE_DICT_CONTENT TO "SPARQL";
GRANT ALL PRIVILEGES TO "SPARQL";</pre>
</div>
<p>(Note that you can uncomment &#8220;drops&#8221; to reset all tables)</p>
<p>Next, click &#8220;RDF&#8221; tab, and click &#8220;Namespaces&#8221;, you must add here all linked ontology namespaces not included in the list. Keep in mind that those namespaces are eligible for use, and that all ontologies specified in &#8220;ONTOLOGY_NAMESPACES&#8221; in Step 3 must appear in this list.</p>
</div>
<div class="section" id="step-2-solr">
<h2>Step 2: Solr<a class="headerlink" href="#step-2-solr" title="Permalink to this headline">¶</a></h2>
<p>Upon Solr installation, a specific schema.xml must be used. This is generated according to mapping specifications (see Step 6) and to a base schema. This base schema is a file placed in &#8220;solr&#8221; directory (referenced in &#8220;SOLR_PATH&#8221; at Step 3), containing exactly the next content:</p>
<div class="highlight-python"><pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!-- DO NOT MODIFY THIS FILE --&gt;

&lt;schema name="mySchema" version="1.4"&gt;

 &lt;types&gt;
    &lt;fieldType name="identifier" class="solr.StrField" sortMissingLast="true" omitNorms="true"/&gt;
    &lt;fieldType name="boolean" class="solr.BoolField" sortMissingLast="true" omitNorms="true"/&gt;
    &lt;fieldType name="long" class="solr.TrieLongField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/&gt;
    &lt;fieldType name="float" class="solr.TrieFloatField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/&gt;
    &lt;fieldType name="int" class="solr.TrieIntField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/&gt;

    &lt;fieldType name="string" class="solr.TextField" sortMissingLast="true" omitNorms="true"&gt;
      &lt;analyzer type="index"&gt;
        &lt;tokenizer class="solr.KeywordTokenizerFactory"/&gt;
        &lt;charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/&gt;
        &lt;charFilter class="solr.HTMLStripCharFilterFactory"/&gt;
      &lt;/analyzer&gt;
      &lt;analyzer type="query"&gt;
        &lt;tokenizer class="solr.KeywordTokenizerFactory"/&gt;
        &lt;charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/&gt;
        &lt;charFilter class="solr.HTMLStripCharFilterFactory"/&gt;
      &lt;/analyzer&gt;
    &lt;/fieldType&gt;

    &lt;fieldType name="text_general" class="solr.TextField" positionIncrementGap="100"&gt;
      &lt;analyzer type="index"&gt;
        &lt;tokenizer class="solr.WhitespaceTokenizerFactory"/&gt;
        &lt;filter class="solr.WordDelimiterFilterFactory"
                        generateWordParts="1" generateNumberParts="1"
                        catenateWords="1" catenateNumbers="1"
                        catenateAll="0" preserveOriginal="1" /&gt;
        &lt;filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/&gt;
        &lt;filter class="solr.LowerCaseFilterFactory" /&gt;
        &lt;filter class="solr.PatternReplaceFilterFactory" pattern="^(\p{Punct}*)(.*?)(\p{Punct}*)$" replacement="$2"/&gt;
        &lt;charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/&gt;
        &lt;charFilter class="solr.HTMLStripCharFilterFactory"/&gt;
      &lt;/analyzer&gt;
      &lt;analyzer type="query"&gt;
        &lt;tokenizer class="solr.WhitespaceTokenizerFactory"/&gt;
        &lt;filter class="solr.WordDelimiterFilterFactory"
                        generateWordParts="1" generateNumberParts="1"
                        catenateWords="0" catenateNumbers="0"
                        catenateAll="0" preserveOriginal="1" /&gt;
        &lt;filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/&gt;
        &lt;filter class="solr.LowerCaseFilterFactory" /&gt;
        &lt;filter class="solr.PatternReplaceFilterFactory" pattern="^(\p{Punct}*)(.*?)(\p{Punct}*)$" replacement="$2"/&gt;
        &lt;charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/&gt;
        &lt;charFilter class="solr.HTMLStripCharFilterFactory"/&gt;
      &lt;/analyzer&gt;
    &lt;/fieldType&gt;
 &lt;/types&gt;

&lt;!-- FIELDS_INSERTION_MARK --&gt;

 &lt;uniqueKey&gt;id&lt;/uniqueKey&gt;

 &lt;defaultSearchField&gt;id&lt;/defaultSearchField&gt;

 &lt;solrQueryParser defaultOperator="OR"/&gt;

&lt;/schema&gt;</pre>
</div>
</div>
<div class="section" id="step-3-main-properties">
<h2>Step 3: Main properties<a class="headerlink" href="#step-3-main-properties" title="Permalink to this headline">¶</a></h2>
<p>The first thing we have to do is to configure the &#8216;config.json&#8217; file, you may place them on your current directory. If you don&#8217;t know which is the current dir you can see the AC log. Here&#8217;s a sample with required properties and possible values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;__comment_0&quot;</span><span class="p">:</span><span class="s">&quot;Mixed config&quot;</span><span class="p">,</span>

        <span class="s">&quot;THUMBNAIL_WIDTH&quot;</span><span class="p">:</span><span class="mi">250</span><span class="p">,</span>
        <span class="s">&quot;THUMBNAIL_HEIGHT&quot;</span><span class="p">:</span><span class="mi">180</span><span class="p">,</span>
        <span class="s">&quot;MEDIA_CONVERSION_PROFILES&quot;</span><span class="p">:[</span><span class="s">&quot;dv mpg avi mov&quot;</span><span class="p">,</span> <span class="s">&quot;dv mpg avi mov&quot;</span><span class="p">,</span> <span class="s">&quot;aif wav mp3&quot;</span><span class="p">],</span>
        <span class="s">&quot;MEDIA_PROFILES_DESCRIPTION&quot;</span><span class="p">:[</span><span class="s">&quot;320p&quot;</span><span class="p">,</span> <span class="s">&quot;640p&quot;</span><span class="p">,</span> <span class="s">&quot;128kbps&quot;</span><span class="p">],</span>
    <span class="s">&quot;MEDIA_AUTOCONVERT&quot;</span><span class="p">:</span><span class="s">&quot;false&quot;</span><span class="p">,</span>
        <span class="s">&quot;LANGUAGE_LIST&quot;</span><span class="p">:[</span><span class="s">&quot;ca&quot;</span><span class="p">,</span> <span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="s">&quot;es&quot;</span><span class="p">,</span> <span class="s">&quot;fr&quot;</span><span class="p">,</span> <span class="s">&quot;it&quot;</span><span class="p">,</span> <span class="s">&quot;de&quot;</span><span class="p">],</span>
        <span class="s">&quot;USER_LEVEL&quot;</span><span class="p">:[</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;Member&quot;</span><span class="p">,</span> <span class="s">&quot;Manager+Reviewer&quot;</span><span class="p">,</span> <span class="s">&quot;Site Administrator&quot;</span><span class="p">],</span>

        <span class="s">&quot;__comment_1&quot;</span><span class="p">:</span><span class="s">&quot;Services base URLs and connection strings&quot;</span><span class="p">,</span>

        <span class="s">&quot;RDFDB_URL&quot;</span><span class="p">:</span><span class="s">&quot;jdbc:virtuoso://myhost:1111&quot;</span><span class="p">,</span>
        <span class="s">&quot;RDFDB_USER&quot;</span><span class="p">:</span><span class="s">&quot;dba&quot;</span><span class="p">,</span>
        <span class="s">&quot;RDFDB_PASS&quot;</span><span class="p">:</span><span class="s">&quot;dba&quot;</span><span class="p">,</span>
        <span class="s">&quot;MEDIA_URL&quot;</span><span class="p">:</span><span class="s">&quot;http://myhost:8080/rest/media/&quot;</span><span class="p">,</span>
        <span class="s">&quot;SOLR_URL&quot;</span><span class="p">:</span><span class="s">&quot;http://myhost:8080/solr/&quot;</span><span class="p">,</span>
        <span class="s">&quot;VIDEO_SERVICES_URL&quot;</span><span class="p">:</span><span class="s">&quot;http://myhost:8080/videoservices/rest/&quot;</span><span class="p">,</span>
        <span class="s">&quot;USER_ROLE_SERVICE_URL&quot;</span><span class="p">:</span><span class="s">&quot;http://myotherhost:8080/myapp/getUserRole?userId=&quot;</span><span class="p">,</span>

    <span class="s">&quot;__comment_2&quot;</span><span class="p">:</span><span class="s">&quot;Ontology namespaces (After any change, all existing triples must be fixed)&quot;</span><span class="p">,</span>

        <span class="s">&quot;RESOURCE_URI_NS&quot;</span><span class="p">:</span><span class="s">&quot;http://localhost:8080/ArtsCombinatoriesRest/resource/&quot;</span><span class="p">,</span>
        <span class="s">&quot;RESOURCE_PREFIX&quot;</span><span class="p">:</span><span class="s">&quot;ac_res&quot;</span><span class="p">,</span>
        <span class="s">&quot;ONTOLOGY_NAMESPACES&quot;</span><span class="p">:[</span>
                <span class="s">&quot;http://localhost:8080/rest/ontology/my#&quot;</span><span class="p">,</span> <span class="s">&quot;my&quot;</span><span class="p">,</span>
                <span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><span class="p">,</span> <span class="s">&quot;rdf&quot;</span><span class="p">,</span>
                <span class="s">&quot;http://www.w3.org/2000/01/rdf-schema#&quot;</span><span class="p">,</span> <span class="s">&quot;rdfs&quot;</span><span class="p">,</span>
                <span class="s">&quot;http://dublincore.org/2010/10/11/dcterms.rdf#&quot;</span><span class="p">,</span> <span class="s">&quot;dcterms&quot;</span>
        <span class="p">],</span>

        <span class="s">&quot;__comment_3&quot;</span><span class="p">:</span><span class="s">&quot;Base directories that will be used by AC to allocate or access content and contiguratios&quot;</span><span class="p">,</span>

        <span class="s">&quot;CONFIGURATIONS_PATH&quot;</span><span class="p">:</span><span class="s">&quot;/achome/json/&quot;</span><span class="p">,</span>
        <span class="s">&quot;SOLR_PATH&quot;</span><span class="p">:</span><span class="s">&quot;/achome/solr/&quot;</span><span class="p">,</span>
        <span class="s">&quot;MEDIA_PATH&quot;</span><span class="p">:</span><span class="s">&quot;/achome/media/&quot;</span><span class="p">,</span>
        <span class="s">&quot;ONTOLOGY_PATH&quot;</span><span class="p">:</span><span class="s">&quot;/achome/myontology.owl&quot;</span><span class="p">,</span>
        <span class="s">&quot;OAI_PATH&quot;</span><span class="p">:</span><span class="s">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>THUMBNAIL_WIDTH</strong> and <strong>THUMBNAIL_HEIGHT</strong> determines the size of generated thumbnails.</p>
<p><strong>MEDIA_CONVERSION_PROFILES</strong> enumerates video/audio file extensions suitable for conversion, ordered by profile number (e.g.: &#8220;dv mpg avi mov&#8221; formats are converted with profile 1 and 2, &#8220;aif wav mp3&#8221; format is converted to profile 3).</p>
<p><strong>MEDIA_PROFILES_DESCRIPTION</strong> enumerates profiles descriptions. This information can be shown at every media URL that appears in object templates (see Visualization).</p>
<p><strong>MEDIA_AUTOCONVERT</strong> set to &#8220;true&#8221; if you require that video/audo files to be converted once uploaded. Otherwise you can use &#8220;convert&#8221; service (see Managing Media section).</p>
<p><strong>LANGUAGE_LIST</strong> enumerates codes of languages that are expected to be used in data base fields (the first one is used as default language).</p>
<p><strong>USER_LEVEL</strong> specifies the degree of legal access that have each user role, ordered from more to less restrictions (&#8220;*&#8221; means any role). This list should contain only 4 elements as there are only 4 restriction levels. Each elements may contain more than one role, separated by &#8216;+&#8217; (p.ex: &#8220;Manager+Reviewer&#8221;)</p>
<p><strong>USER_ROLE_SERVICE_URL</strong> is a specific service url. This service is used by AC to resolve user groups, which will be considered to determine the permission acess of the user. Service must accept a user identifier (in the URL string) and should return one of the user groups specified in USER_LEVEL.</p>
<p><strong>ONTOLOGY_NAMESPACES</strong> establishes a prefix for each ontology/schema namespace, this prefix must also appear on namespaces list in Virtuoso (see Step 1). The first specified ontology must be the one specially created for this project (myOntology in the example), other specified ontologies/schemas must be the ones included on the first one. Generally, RDF and RDFS schemas should be always included.</p>
<p><strong>MEDIA_URL</strong> is the URL where medias will be accessible at, this can target our Tomcat server media service (as shown in the example) or can target a streaming server such as Lighttpd. Unlike other URLs which can point to localhost if applies, this MUST be the external URL of the server even if its running from the same machine as Tomcat or it is Tomcat itself.</p>
<p><strong>Note</strong></p>
<p>If Lighttpd is used, lighttpd.conf file must be properly configured and <strong>server.document-root</strong> variable must target to the same directory as &#8220;MEDIA_PATH&#8221; of our configuration.</p>
<p>AC requires the next folder and file structure in order to allocate and use its files:</p>
<ul>
<li><dl class="first docutils">
<dt>[CONFIGURATIONS_PATH]</dt>
<dd><ul class="first last simple">
<li>legal/legal.json (required)</li>
<li>mapping/mapping.json (required)</li>
<li>mapping/search.json (optional)</li>
<li>mapping/ (optionally, json template definitons for any Ontology class named with prefix, example &#8220;foaf:Person.json&#8221;)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>[SOLR_PATH] (Sorl home path)</dt>
<dd><ul class="first last simple">
<li>conf/schema.xml-EMPTY (required)</li>
<li>data/data.xml (generated by application after indexing)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>[MEDIA_PATH]</dt>
<dd><ul class="first last simple">
<li>thumbnail/</li>
<li>thumbnail/classes/default.jpg (required. Default thumbnail for all objects. Does not need to fit a specific size)</li>
<li>thumbnail/classes/ (optionally, default thumbnail for any classes Ontology class named with prefix, example &#8220;foaf:Person.jpg&#8221;)</li>
<li>tmp/ (required. Empty directory)</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">[ONTOLOGY_PATH] (path to file containing the project&#8217;s Ontology)</p>
</li>
</ul>
<p>OAI_PATH is an optinal property explained in detail in OAI PMH Support section</p>
</div>
<div class="section" id="step-4-reset">
<h2>Step 4: Reset<a class="headerlink" href="#step-4-reset" title="Permalink to this headline">¶</a></h2>
<p>Calling reset service, ALL data and media will be removed. Also last Ontology file (located in ONTOLOGY_PATH) will be loaded.</p>
<div class="highlight-python"><pre>Service path: http://{host:port}/{appname}/reset?option=ontology&amp;confirm=CURRENT_DATE
HTTP Method: GET
Returns: "success" or "error"</pre>
</div>
<p>Set &#8220;option=ontology&#8221; if you do not want a total reset, but only a reload of all ontologies specified in ONTOLOGY_NAMESPACES.</p>
<p>Otherwise, for safety, &#8220;confirm&#8221; must be filled with current server date and time formated as &#8220;dd/mm/yy hh:mm&#8221;</p>
<p><strong>Examples</strong></p>
<div class="highlight-python"><pre>http://internetdomain.org/ac/reset?option=ontology               // ontologies reload</pre>
</div>
<div class="highlight-python"><pre>http://internetdomain.org/ac/reset?confirm=11/11/2011 23:11      // data reset and ontologies reload</pre>
</div>
</div>
<div class="section" id="step-5-legal-script">
<h2>Step 5: Legal script<a class="headerlink" href="#step-5-legal-script" title="Permalink to this headline">¶</a></h2>
<p>AC provides capabilities for assigning legal rights to media objects. The right assignation is an user assisted process that can be scripted and fully customized. (If you have no intention to apply this feature you may skip this step).</p>
<p>There is a self-explanatory sample named &#8216;legal.json&#8217; in json directory, &#8216;legal&#8217; subfolder. &#8216;legal.json&#8217; is the name of the script file that will assist the user, the main parts of the script are:</p>
<ul class="simple">
<li>Start Block: starting block of the script</li>
<li>Blocks: list of blocks the process will run through.</li>
<li>Block name: name of block user for referencing it from other blocks</li>
<li>Block description: additional explanation of block aim</li>
<li>Block data: data that will be requested to user (as a user form) and will be used to resolve the right assignation. This data is considered global, so it can be reused or reassigned in further blocks.</li>
<li>Block rules: data evaluation using boolean expressions. It can result to a next block, indicaded by &#8216;block&#8217; keyword, or to a color indicated by &#8216;result&#8217; keyword. Color consequences is explained next.</li>
</ul>
<p>There are four &#8220;trafic light&#8221; colors that can be assigned to any object as a result of the legal process. From less to more restrictive: &#8220;green&#8221;, &#8220;yellow&#8221;, &#8220;orange&#8221; and &#8220;red&#8221;. Each of one corresponding to one accessing right level from 1 to 4. On every call to a service that provides media data, the accessing level must be specified. Service will fail if user accessing level is lower than object restriction level. Eg. User level = 1 , Object level = 2 &#8211;&gt; Fail / User level = 2 , Object level = 2 &#8211;&gt; OK.</p>
<ul class="simple">
<li>Besides color result, license can also be assigned to the object. This is achieved by &#8220;license&#8221; clause. Its value can be as &#8220;my:hasLicense=License_ID&#8221;, in other words: property name, &#8220;=&#8221; sign, and the ontologic object that corresponds to a license (for instance &#8220;Creative_Commons_ID&#8221;). This process does not check at all the consistency of the assigned license, this could even be any type of object. It corresponds to the user to seek the consistency of this process.</li>
</ul>
</div>
<div class="section" id="step-6-data-mapping">
<h2>Step 6: Data mapping<a class="headerlink" href="#step-6-data-mapping" title="Permalink to this headline">¶</a></h2>
<p>Data &#8220;mapping.json&#8221; (placed in json/mapping folder) is a must-have specification file that defines what ontology data must be indexed in Solr, and how this must be done. Data mapping is not a simple direct Owl to Solr mapping. It must be defined in a way that it later can be used for specific object domain searches (See Step 4), and provide additional information of the field nature to get Solr treating the data properly.</p>
<p>Let&#8217;s say we have the Person class defined in our Ontology, and that we want to indexate several useful person data such as: name, biography, date of birth and birth place. Person indexing should be specified this way:</p>
<div class="highlight-python"><pre>{
        "data":
        [
        {
            "name":"Name",                      // Specifies the data identifier, in this case, the person Name
            "type":"string",                    // 'string' type means that values of Name will be treated as a whole
            "path":["my:Person.my:fullName"]    // Path to Class data property, note that it's specified as (Class-name).(property)
        },

        {
            "name":"Biography",
            "type":"text",                  // 'text' makes every word (space separated tokens) to be treated separately on search
            "path":["my:Person.my:Bio"]
        },

        {
            "name":"BirthDate",
            "type":"date.year",             // 'date.year' will extract the year part of date value (default date format expected is dd/mm/yyyy)
            "path":["my:Person.my:BirthDate"]
        },

        {
            "name":"BirthPlace",
            "type":"string",
            "path":["my:Person.my:BirthPlace=my:Location.my:Name"]   // Note that as Birth Place is not a string but an external object, specified path chains both objects, from original, to target data (Name property of Location class). You can chain as many objects as you need.
        }
    ]
}</pre>
</div>
<p>Note that path is a json array, this makes it possible to specify various object indexing. Let&#8217;s suppose that we want to indexate one more object: Locations (with property Name). Code should be modified as follows:</p>
<div class="highlight-python"><pre>"data":
    [
        {
            "name":"ObjectClass",           // This is not mandatory but totally recommended: As we have now more than one object type,
                                            // specifying this data, will allow filtering searches by object class.
            "type":"string",
            "path":["*.class"]              // We want no specific class by '*' character instead of class name,
                                            // and we use reserved word 'class' to get the indexated object class name.
                                            // 'superclass', and 'id' are also a reserved words, with obvious results.
        },

        {
            "name":"Name",
            "type":"string",
            "path":["my:Person.my:fullName", "my:Location.my:Name"]     // Path to Person and Location data property
        },

        /* rest of json ... */
    ]</pre>
</div>
<p>To provide proper searches, we can specify additional clauses for each data:</p>
<ul class="simple">
<li><strong>category</strong>: Solr searches will use &#8216;facets&#8217; feature to categorize specified data values by grouping and counting equal matches.</li>
<li><strong>multilingual</strong>: Applicable to data introduced in various languages in RDF database. For instance, a person biography can be written in different languages. This prevents Solr search from returning the same data in different languages.</li>
<li><strong>search</strong>: This might sound obvious that all mapped data should be user for search, but it&#8217;s not. There may be data that&#8217;s interesting only as a search result but not for searching in its string value. Unless you specify this clause, mapped data is not considered for searching.</li>
<li><strong>autocomplete</strong>: Only if you specified the previous clause, you can activate autocomplete to get this data in the autocomplete search.</li>
</ul>
<p>For example: &#8216;Name&#8217; data (that is, person and location name) is interesting for search and autocomplete. But Person name is specified in single language, and Location name is specified in different languages. Also, we find interesting to categorize results by locations but not by persons. According to all this, previous json code should change as follows:</p>
<div class="highlight-python"><pre>"data":
    [
        {
            "name":"Person",
            "type":"string",
            "path":["my:Person.my:fullName"],
            "search":"yes",
            "autocomplete":"yes"
        },

        {
            "name":"Location",
            "type":"string",
            "path":["my:Location.my:Name", "my:Person.my:BirthPlace=my:Location.my:Name"]
            "search":"yes",                     // Note that ALL clauses are unactive by default,
            "autocomplete":"yes",               // so they must be always specified in case of need.
            "multilingual":"yes",
            "category":"yes"
        }

        /* rest of json ... */
    ]</pre>
</div>
<p>Recommended practice:
- Group all text data -this is, all those that must be searched in word-by-word basis- inside the same data block, as &#8220;text&#8221; type.
- If it is required, also, categorize all results of some data already included in previous block, create a new block of type &#8220;string&#8221; and refer to the same data &#8220;path&#8221;, and use clause &#8220;category:yes&#8221;.
- If it is required, also, to use this data to sort results, create a new block of type &#8220;string&#8221; and again, refer to same data &#8220;path&#8221;, and use clause &#8220;sort:yes&#8221;-
- About previous point, if sorting must be over different data of the same kind, include them all in the same block.</p>
<p>In short, it&#8217;s recommended to sepparate data blocks by its function (search, category or sorting). Next mapping example shows all explained practices:</p>
<div class="highlight-python"><pre>"data":
    [
        {
            "name":"Word_by_word_text_search",
            "type":"text",
            "path":[
                    "my:Person.my:fullName",                                                        // allows finding persons by name
                    "my:Person.my:biography",                                                       // allows finding persons by bio
                    "my:Person.my:BirthPlace=my:Location.my:Name",          // allows finding persons by birthplace
                    "my:Location.my:Name",                                                          // allows finding places by name
                    "my:Location.my:description"                                            // allows finding places by description
            ],
            "search":"yes",
            "autocomplete":"yes"
        },

        {
            "name":"Place_category",
            "type":"string",
            "path":[
                    "my:Location.my:Name",                                                          // categorizes places
                    "my:Person.my:BirthPlace=my:Location.my:Name"           // categorizes persons birthplace
            ]
            "category":"yes"
        },

        {
            "name":"Year_sorting",
            "type":"date.year",
            "path":[
                    "my:Person.my:BirthDate",                                                       // allows sorting by birth year
                    "my:Location.my:FoundationDate"                                 // allows sorting by foundation year
            ]
            "sort":"yes"
        }

    ]</pre>
</div>
</div>
<div class="section" id="step-7-object-template">
<h2>Step 7: Object template<a class="headerlink" href="#step-7-object-template" title="Permalink to this headline">¶</a></h2>
<p>Any resource search will finally lead to individual object visualization. This makes it necessary to build templates for any Ontology object that should be visualizable. Object view is organized in sections, and each section contains a list of mapped data, in a similar way we used it in previous step.</p>
<p>Going back to Person object class example: name, birth date, and birth place should be placed at header. Biography can be placed at body, we can also use a &#8216;knows&#8217; relation to get related Persons and we can place this at footer section. (Note that sections are totally customizable).</p>
<p>The resulting template file must be placed as &#8220;Person.json&#8221; (generally, (Class-name).json) in json/mapping directory. Code should look as follows:</p>
<div class="highlight-python"><pre>{
        "className":"Person",

        "sections":
        [
                {
                        "name":"header",                    // section name
                        "data":[

                            {
                                        "name":"Name",
                                        "type":"text",
                                        "path":["my:Person.my:fullName"]
                                },

                {
                                        "name":"BirthDate",
                                        "type":"date",
                                        "path":["my:Person.my:BirthDate"]
                                },

                {
                                        "name":"BirthPlace",
                                        "type":"linkedObject",
                                        "path":["my:Person.my:BirthPlace=my:Location.my:Name"]
                                }
                        ]
                },

                {
                        "name":"body",
                        "data":[

                            {
                                "name":"Biography",
                                "type":"text",
                                "path":["my:Person.my:Bio"]
                            }
                        ]
                },

        {
                        "name":"footer",
                        "data":[

                            {
                                        "name":"Related",
                                        "type":"search",
                    "path":["my:Person.id"],
                    "value":["RelatedPeople:"],
                    "categories":["Year", "Location"]
                                }
                        ]
                }
        ]
}</pre>
</div>
<p>Data &#8216;type&#8217; clause has not much to do with &#8216;type&#8217; defined in previous step. The following types are all the ones available for templates:</p>
<ul class="simple">
<li><strong>text</strong>: suitable for most cases, it resolves path to literal value with no modification.</li>
<li><strong>linkedObject</strong>: it shows resolved data path along with the referenced object id, separated by &#8216;&#64;&#8217;. For example: <a class="reference external" href="mailto:London&#37;&#52;&#48;my_london_id">London<span>&#64;</span>my_london_id</a>, this allows to create an hyperlink to the referenced object, which would be <a class="reference external" href="http://internetdomain.org/ac/resource/my_london_id/">http://internetdomain.org/ac/resource/my_london_id/</a>...</li>
<li><strong>objects</strong>: resolves path to identifier value.</li>
<li><strong>media</strong>: resolves path to media url value.</li>
<li><strong>date</strong>: and its parts (<strong>date.year</strong>, <strong>date.day</strong>, <strong>date.month</strong>). Same effect as date defined at step 3.</li>
<li><strong>search</strong>: this is a quite sophisticated object that comprises Solr searching feature from indexed data filtered by the specified constraint defined as combination of value and path. In this example: the search will only result to persons (&#8220;Person.knows:&#8221;) that know current person (&#8220;Person.id&#8221;). For detailed information about searches please see Visualization page.</li>
<li><strong>counter</strong>: groups and counts same value results.</li>
</ul>
<p>Please note that <strong>text</strong>, <strong>objects</strong> and <strong>media</strong> have the same effect. They resolve the path the same way but resulting value type is supposed to be different. See Visualization Object Thumbnail section to further in <strong>media</strong> and <strong>objects</strong> types.</p>
</div>
</div>
<div class="section" id="step-8-video-profiles">
<h1>Step 8: Video Profiles<a class="headerlink" href="#step-8-video-profiles" title="Permalink to this headline">¶</a></h1>
<p>To configure video conversion profiles already mentioned in Step 3..... <strong>TODO: I2CAT explicar la configuració dels perfils de vídeo</strong></p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="managing_data.html" title="Managing data"
             >next</a> |</li>
        <li class="right" >
          <a href="migracio.html" title="Migració"
             >previous</a> |</li>
        <li><a href="index.html">FAT Arts Combinatòries 1.0a1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, FAT - UPCnet.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>